!function(e,t){if("function"==typeof define&&define.amd)define(["exports","cropperjs/dist/cropper.css","cropperjs","mime/lite","vue"],t);else if("undefined"!=typeof exports)t(exports,require("cropperjs/dist/cropper.css"),require("cropperjs"),require("mime/lite"),require("vue"));else{var r={exports:{}};t(r.exports,e.cropper,e.cropperjs,e.lite,e.vue),e.unknown=r.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(e,t,r,n,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,p=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){p=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(p)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t,r,n,a,o,i){try{var p=e[o](i),l=p.value}catch(e){return void r(e)}p.done?t(l):Promise.resolve(l).then(n,a)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r=o(r),n=o(n);var c=(0,a.defineComponent)({name:"AvatarCropper",emits:["update:modelValue","submit","error","cancel","changed","uploading","completed","uploaded"],props:{modelValue:{type:Boolean,default:!1},file:{type:File},uploadHandler:{type:Function},uploadUrl:{type:String},requestOptions:{type:Object,default:function(){return{method:"POST"}}},uploadFileField:{type:String,default:"file"},uploadFileName:{type:[String,Function]},uploadFormData:{type:FormData,default:function(){return new FormData}},cropperOptions:{type:Object,default:function(){return{aspectRatio:1,autoCropArea:1,viewMode:1,movable:!1,zoomable:!1}}},outputOptions:{type:Object},outputMime:{type:String,default:null},outputQuality:{type:Number,default:.9},mimes:{type:String,default:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},capture:{type:String},labels:{type:Object,default:function(){return{submit:"Ok",cancel:"Cancel"}}},inline:{type:Boolean,default:!1}},data:function(){return{cropper:void 0,dataUrl:void 0,fileName:void 0,mimeType:void 0}},computed:{cleanedMimes:function(){if(!this.mimes)throw new Error("vue-avatar-cropper: mimes prop cannot be empty");return this.mimes.trim().toLowerCase()}},watch:{modelValue:function(e){e&&(this.file?this.onFileChange(this.file):this.pickImage(),this.$emit("update:modelValue",!1))}},mounted:function(){this.$emit("update:modelValue",!1)},methods:{destroy:function(){this.cropper&&this.cropper.destroy(),this.$refs.input&&(this.$refs.input.value=""),this.dataUrl=void 0},submit:function(){this.$emit("submit"),this.uploadUrl?this.uploadImage():this.uploadHandler?this.uploadHandler(this.cropper):this.$emit("error",{type:"user",message:"No upload handler found"}),this.destroy()},cancel:function(){this.$emit("cancel"),this.destroy()},onImgElementError:function(){this.$emit("error",{type:"load",message:"File loading failed"}),this.destroy()},pickImage:function(){this.$refs.input&&this.$refs.input.click()},onFileChange:function(e){var t=this;if("image/*"===this.cleanedMimes){if("image"!==e.type.split("/")[0])return void this.$emit("error",{type:"user",message:"File type not correct"})}else if(this.cleanedMimes){if(!this.cleanedMimes.split(", ").find((function(t){return t===e.type})))return void this.$emit("error",{type:"user",message:"File type not correct"})}var r=new FileReader;r.onload=function(e){t.dataUrl=e.target.result},r.readAsDataURL(e),this.fileName=e.name||"unknown",this.mimeType=e.type,this.$emit("changed",{file:e,reader:r})},onFileInputChange:function(e){e.target.files&&e.target.files[0]&&this.onFileChange(e.target.files[0])},createCropper:function(){this.cropper=new r.default(this.$refs.img,this.cropperOptions)},getFilename:function(e){var t=n.default.getExtension(e.type);if(!this.uploadFileName){var r=this.fileName,a=this.fileName.split(".");return a.length>1&&(r=a.slice(0,-1).join(".")),"".concat(r,".").concat(t)}return"string"==typeof this.uploadFileName?this.uploadFileName:"function"==typeof this.uploadFileName?this.uploadFileName({filename:this.fileName,mime:e.type,extension:t}):"unknown.".concat(t)},uploadImage:function(){var e=this;this.cropper.getCroppedCanvas(this.outputOptions).toBlob(function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var n,a,o,p,l,c,s,u,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a in n=new FormData,e.uploadFormData.entries())o=i(a,2),p=o[0],l=o[1],n.append(p,l);return n.append(e.uploadFileField,r,e.getFilename(r)),c=Object.assign({body:n},e.requestOptions),s=new Request(e.uploadUrl,c),u=fetch(s),e.$emit("uploading",{form:n,request:s,response:u}),t.next=9,u;case 9:d=t.sent,e.$emit("completed",{form:n,request:s,response:d}),d.ok?e.$emit("uploaded",{form:n,request:s,response:d}):e.$emit("error",{type:"upload",message:"Image upload fail",context:{request:s,response:d}});case 12:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(e){l(o,n,a,i,p,"next",e)}function p(e){l(o,n,a,i,p,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),this.outputMime||this.mimeType,this.outputQuality)}}});e.default=c;var s={class:"avatar-cropper"},u={key:0,class:"avatar-cropper-mark"},d=["title"],m={class:"avatar-cropper-container"},f={class:"avatar-cropper-image-container"},h=["src"],v={class:"avatar-cropper-footer"},y=["accept","capture"];!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===r&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".avatar-cropper .avatar-cropper-overlay {\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99999; }\n\n.avatar-cropper .avatar-cropper-overlay-inline {\n  position: initial; }\n\n.avatar-cropper .avatar-cropper-img-input {\n  display: none; }\n\n.avatar-cropper .avatar-cropper-close {\n  float: right;\n  padding: 20px;\n  font-size: 3rem;\n  color: #fff;\n  font-weight: 100;\n  text-shadow: 0px 1px rgba(40, 40, 40, 0.3); }\n\n.avatar-cropper .avatar-cropper-mark {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.1); }\n\n.avatar-cropper .avatar-cropper-container {\n  background: #fff;\n  z-index: 999;\n  box-shadow: 1px 1px 5px rgba(100, 100, 100, 0.14); }\n  .avatar-cropper .avatar-cropper-container .avatar-cropper-image-container {\n    position: relative;\n    max-width: 400px;\n    height: 300px; }\n  .avatar-cropper .avatar-cropper-container img {\n    max-width: 100%;\n    height: 100%; }\n  .avatar-cropper .avatar-cropper-container .avatar-cropper-footer {\n    display: flex;\n    align-items: stretch;\n    align-content: stretch;\n    justify-content: space-between; }\n    .avatar-cropper .avatar-cropper-container .avatar-cropper-footer .avatar-cropper-btn {\n      width: 50%;\n      padding: 15px 0;\n      cursor: pointer;\n      border: none;\n      background: transparent;\n      outline: none; }\n      .avatar-cropper .avatar-cropper-container .avatar-cropper-footer .avatar-cropper-btn:hover {\n        background-color: #2aabd2;\n        color: #fff; }\n"),c.render=function(e,t,r,n,o,i){return(0,a.openBlock)(),(0,a.createElementBlock)("div",s,[e.dataUrl?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:(0,a.normalizeClass)(["avatar-cropper-overlay",{"avatar-cropper-overlay-inline":e.inline}])},[e.inline?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",u,[(0,a.createElementVNode)("a",{onClick:t[0]||(t[0]=function(){return e.cancel&&e.cancel.apply(e,arguments)}),class:"avatar-cropper-close",title:e.labels.cancel,href:"javascript:;"}," Ã— ",8,d)])),(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",f,[(0,a.createElementVNode)("img",{ref:"img",src:e.dataUrl,alt:"",onLoad:t[1]||(t[1]=(0,a.withModifiers)((function(){return e.createCropper&&e.createCropper.apply(e,arguments)}),["stop"])),onError:t[2]||(t[2]=function(){return e.onImgElementError&&e.onImgElementError.apply(e,arguments)})},null,40,h)]),(0,a.createElementVNode)("div",v,[(0,a.createElementVNode)("button",{onClick:t[3]||(t[3]=(0,a.withModifiers)((function(){return e.cancel&&e.cancel.apply(e,arguments)}),["stop","prevent"])),class:"avatar-cropper-btn"},(0,a.toDisplayString)(e.labels.cancel),1),(0,a.createElementVNode)("button",{onClick:t[4]||(t[4]=(0,a.withModifiers)((function(){return e.submit&&e.submit.apply(e,arguments)}),["stop","prevent"])),class:"avatar-cropper-btn"},(0,a.toDisplayString)(e.labels.submit),1)])])],2)):(0,a.createCommentVNode)("",!0),e.file?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:1,accept:e.cleanedMimes,capture:e.capture,class:"avatar-cropper-img-input",ref:"input",type:"file",onChange:t[5]||(t[5]=function(){return e.onFileInputChange&&e.onFileInputChange.apply(e,arguments)})},null,40,y))])},c.install=function(e){e.component("avatar-cropper",c)}}));
